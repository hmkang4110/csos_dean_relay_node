# ==============================================================================
# 1. Bluetooth 기본 및 역할 설정 (Bluetooth Basic & Roles)
# ==============================================================================
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_CENTRAL=y
CONFIG_BT_DEVICE_NAME="DE&N_RELAY"
CONFIG_BT_DEVICE_APPEARANCE=832

# ==============================================================================
# 2. 연결 및 버퍼 설정 (Connection & Buffers)
# [중요] N:1 연결 및 안정성을 위한 핵심 설정입니다.
# 규칙: RX 버퍼(32) > 최대 연결 수(19) 조건을 만족해야 빌드 에러가 없습니다.
# ==============================================================================
# 최대 연결 수 (DEAN 노드 + SLIMHUB)
CONFIG_BT_MAX_CONN=19
CONFIG_BT_MAX_PAIRED=19

# 데이터 처리 버퍼 (연결 수보다 여유 있게 설정)
CONFIG_BT_BUF_ACL_RX_COUNT=32
CONFIG_BT_BUF_ACL_TX_COUNT=32

# ==============================================================================
# 3. 확장 광고 및 멀티 ID 설정 (Extended Advertising & Multi-Identity)
# [핵심] 투명 라우팅(Relaying)을 위해 여러 개의 가상 DEAN을 흉내 내기 위한 설정입니다.
# ==============================================================================
# Extended Advertising 활성화
CONFIG_BT_EXT_ADV=y
CONFIG_BT_CTLR_TX_PWR_DYNAMIC_CONTROL=y

# 동시에 유지할 수 있는 광고 세트 수 (RELAY 자신 + 가상 DEAN들)
CONFIG_BT_EXT_ADV_MAX_ADV_SET=10

# 생성 가능한 MAC 주소(Identity) 개수 (각 가상 DEAN마다 다른 MAC 주소 할당)
CONFIG_BT_ID_MAX=11

# ==============================================================================
# 4. GATT 및 보안 설정 (GATT & Security)
# ==============================================================================
CONFIG_BT_SMP=y
CONFIG_BT_GATT_CLIENT=y
CONFIG_BT_GATT_DM=y
CONFIG_BT_GATT_DM_MAX_ATTRS=80
CONFIG_BT_GATT_AUTO_DISCOVER_CCC=n
CONFIG_BT_GATT_AUTO_UPDATE_MTU=y
CONFIG_BT_GATT_AUTO_DISCOVER_CCC=n

# (스캔 관련 설정 - 현재 비활성화 상태 유지)
# CONFIG_BT_SCAN=y
# CONFIG_BT_SCAN_FILTER_ENABLE=y
# CONFIG_BT_SCAN_UUID_CNT=6
# CONFIG_BT_SCAN_NAME_CNT=4
# CONFIG_BT_SCAN_ADDR_CNT=4

# ==============================================================================
# 5. 시스템 메모리 및 플래시 (System Memory & Flash)
# [중요] Extended Adv와 다중 연결 객체 생성을 위해 힙 메모리를 충분히 확보했습니다.
# ==============================================================================
CONFIG_HEAP_MEM_POOL_SIZE=8192

CONFIG_SETTINGS=y
CONFIG_BT_SETTINGS=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y

# ==============================================================================
# 6. 로깅 및 디버그 (Logging & Debug - RTT)
# ==============================================================================
CONFIG_LOG=y
CONFIG_CONSOLE=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_PRINTK=y
CONFIG_LOG_MODE_IMMEDIATE=y

# RTT(Real Time Transfer) 사용 설정 (UART 대신 J-Link 통해 로그 출력)
CONFIG_USE_SEGGER_RTT=y
CONFIG_LOG_BACKEND_RTT=y
CONFIG_RTT_CONSOLE=y
CONFIG_UART_CONSOLE=n

# ==============================================================================
# 7. 하드웨어 및 스토리지 (Hardware & Storage - SD Card)
# ==============================================================================
CONFIG_DK_LIBRARY=y
CONFIG_DISK_ACCESS=y
CONFIG_DISK_DRIVER_SDMMC=y
CONFIG_FILE_SYSTEM=y
CONFIG_FAT_FILESYSTEM_ELM=y
CONFIG_SPI_NRFX_RAM_BUFFER_SIZE=64

# ==============================================================================
# 8. 부트로더 및 이미지 관리 (Bootloader & Image)
# ==============================================================================
CONFIG_BOOTLOADER_MCUBOOT=n
CONFIG_PM_SINGLE_IMAGE=y
